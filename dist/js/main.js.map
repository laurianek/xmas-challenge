{"version":3,"sources":["app.js","grid.js","player.js","lib/arrayReducePolyfill.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["'use strict';\n\nvar app = angular.module('tictactoe', []);\n\napp.constant('GameConst', {\n  NOUGHT: 'nought',\n  CROSS: 'cross',\n  NOUGHT_CLASS: 'symbol-nought',\n  CROSS_CLASS: 'symbol-cross',\n  WIN_POINT: 1,\n  DRAW_POINT: 0.5\n});\n\napp.controller('mainCtrl', function($scope, GameConst) {\n  var grid = new Grid();\n  var player1 = new Player('Player 1', {\n    symbol: GameConst.NOUGHT,\n    _class: GameConst.NOUGHT_CLASS\n  });\n  var player2 = new Player('Player 2', {\n    symbol: GameConst.CROSS,\n    _class: GameConst.CROSS_CLASS\n  });\n  var isPlayer1Turn = true;\n  $scope.grid = grid;\n  $scope.players = [player1, player2];\n  $scope.config = {\n    colour: 'colour',\n    symbol: 'marker',\n    score: 'score'\n  };\n  $scope.isCurrentPlayer = isCurrentPlayer;\n  $scope.mark = mark;\n\n  function mark(row, col) {\n    var success = grid.mark({row: row, col: col}, currentPlayer().marker);\n    if(!success) {\n      //maybe notify the user that marking failed\n      return;\n    }\n    if (success.isGameWon) {\n      currentPlayer().addPoints(GameConst.WIN_POINT);\n      //display message thw current player win and ask for replay\n      return;\n    }\n    changePlayer();\n  }\n  function currentPlayer() {\n    return isPlayer1Turn? player1 : player2;\n  }\n  function changePlayer() {\n    return isPlayer1Turn = !isPlayer1Turn;\n  }\n  function isCurrentPlayer(player) {\n    return player.marker === currentPlayer().marker;\n  }\n});","'use strict';\n\nclass Grid {\n  constructor(square = 3) {\n    this.square = square;\n    this.grid = [];\n    this.gameOver = false;\n    for (let row = 0; row < this.square; row++) {\n      this.grid[row] = [];\n      for (let col = 0; col < this.square; col++) {\n        this.grid[row][col] = null;\n      }\n    }\n  }\n  mark(position, marker) {\n    if (this.gameOver) {\n      return false;\n    }\n    if (!this.withinGridBounds(position) || this.isAlreayMarked(position)) {\n      return false;\n    }\n    this.grid[position.row][position.col] = marker;\n    var game = this.gameWon(position);\n    this.gameOver = game.isGameWon;\n    return game;\n  }\n  withinGridBounds(position) {\n    return (position.row >= 0 && position.row < this.square) &&\n      (position.col >= 0 && position.col < this.square);\n  }\n  isAlreayMarked(position) {\n    return this.grid[position.row][position.col];\n  }\n  winReduce(position, mark, fns) {\n    if(fns.extraCheck && fns.extraCheck(position)) {\n      return false;\n    }\n    for (let i = 0, j = this.square-1, cell; i < this.square; i++, j--) {\n      cell = fns.cell(position, i, j);\n      console.log('cell', cell);\n      if (!cell || cell.symbol !== mark.symbol) {\n        return false;\n      }\n    }\n    return fns.returnValue;\n  }\n  gameWon(position) {\n    var _this = this;\n    var currentMark = this.isAlreayMarked(position);\n    var checks = [\n      {\n        cell: function hzw (position, i, j) { return _this.grid[position.row][i]; },\n        returnValue: Grid.enum().HZ_WIN\n      },\n      {\n        cell: function vtw (position, i, j) { return _this.grid[i][position.col]; },\n        returnValue: Grid.enum().VT_WIN\n      },\n      {\n        cell: function lhdw(position, i, j) { return _this.grid[i][i]; },\n        extraCheck: function extraCheck(position) { return position.row !== position.col },\n        returnValue: Grid.enum().LHD_WIN\n      },\n      {\n        cell: function rhdw(position, i, j) { return _this.grid[i][j]; },\n        extraCheck: function extraCheck(position) { return position.row !== _this.square - 1 - position.col },\n        returnValue: Grid.enum().RHD_WIN\n      }\n    ];\n    var win = checks.reduce(function winReduceFn(previousValue, currentObj) {\n      if (previousValue) {\n        return previousValue;\n      }\n      return _this.winReduce(position, currentMark, currentObj);\n    }, false);\n    console.log(win);\n    if (win) {\n      return { isGameWon: true, winType: win };\n    }\n    return { isGameWon: false, winType: '' };\n  }\n\n  static enum() {\n    return {\n      HZ_WIN: 'horizontal win',\n      VT_WIN: 'vertical win',\n      LHD_WIN: 'left hand-side diagonal win',\n      RHD_WIN: 'right hand-side diagonal win'\n    }\n  }\n}","'use strict';\n\nclass Player {\n  constructor (name, marker, score = 0) {\n    this.name = name;\n    this.marker = marker;\n    this.score = score;\n  }\n\n  addPoints(_point) {\n    var point = Number(_point);\n    if(point) {\n      this.score += point\n    }\n  }\n}","// Production steps of ECMA-262, Edition 5, 15.4.4.21\n// Reference: http://es5.github.io/#x15.4.4.21\nif (!Array.prototype.reduce) {\n  Array.prototype.reduce = function(callback /*, initialValue*/) {\n    'use strict';\n    if (this == null) {\n      throw new TypeError('Array.prototype.reduce called on null or undefined');\n    }\n    if (typeof callback !== 'function') {\n      throw new TypeError(callback + ' is not a function');\n    }\n    var t = Object(this), len = t.length >>> 0, k = 0, value;\n    if (arguments.length == 2) {\n      value = arguments[1];\n    } else {\n      while (k < len && !(k in t)) {\n        k++;\n      }\n      if (k >= len) {\n        throw new TypeError('Reduce of empty array with no initial value');\n      }\n      value = t[k++];\n    }\n    for (; k < len; k++) {\n      if (k in t) {\n        value = callback(value, t[k], k, t);\n      }\n    }\n    return value;\n  };\n}"],"sourceRoot":"/source/"}